#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running Flutter pre-push checks..."

# 1ï¸âƒ£ Run unit tests
echo "ğŸ§ª Running flutter test..."
flutter test || { echo "âŒ Unit tests failed."; exit 1; }

# 2ï¸âƒ£ Validate branch name
BRANCH_NAME=$(git rev-parse --abbrev-ref HEAD)
echo "ğŸ”– Validating branch name: $BRANCH_NAME"
if [[ ! "$BRANCH_NAME" =~ ^(feature|bugfix|release)\/[a-zA-Z0-9_-]+$ ]]; then
  echo "âŒ Invalid branch name: $BRANCH_NAME"
  echo "Branch names must start with feature/, bugfix/, or release/ followed by a description."
  exit 1
fi

echo "âœ… All pre-push checks passed!"
